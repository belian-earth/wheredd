% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/carbon_proj_db.R
\name{carbon_proj_db}
\alias{carbon_proj_db}
\title{Build Carbon Project Database}
\usage{
carbon_proj_db(
  dest = NULL,
  db_name = "wheredd_db",
  continents = c("africa", "asia", "europe", "north_america", "oceania", "south_america"),
  force = FALSE,
  build_from = c("release", "source"),
  tag = "latest"
)
}
\arguments{
\item{dest}{Directory path where the database will be created. If NULL
(default), uses the system cache directory via \code{rappdirs::user_cache_dir("wheredd")}.}

\item{db_name}{Name of the database file (without extension). Default is "wheredd_db".}

\item{continents}{Character vector of continent names to include. Valid values
are "africa", "asia", "europe", "north_america", "oceania", and "south_america".
Default is all continents. Multiple values are allowed.}

\item{force}{Logical. If TRUE, removes and rebuilds existing database. If FALSE
(default), returns existing database path without rebuilding.}

\item{build_from}{Character string specifying the data source. Either "release"
(default, downloads pre-processed data from GitHub releases - faster) or
"source" (processes raw parquet files with full geometry cleaning - slower).}

\item{tag}{Character string specifying the GitHub release tag to use when
\code{build_from = "release"}. Default is "latest". Ignored when \code{build_from = "source"}.}
}
\value{
The file path to the created database, returned invisibly.
}
\description{
Creates a local DuckDB database containing forest carbon project boundaries
and metadata. The database can be built either from a pre-processed GitHub
release (fast) or from source parquet files (slower, but with fresh data and
full geometry processing).
}
\details{
The function creates a DuckDB database with the following structure:
\itemize{
\item One row per project per area type (project, accounting, reference)
\item Geometries stored as WKB blobs for efficient storage
\item Data ordered by continent, country, and project ID
}

When \code{build_from = "release"}:
\itemize{
\item Downloads pre-processed parquet file from GitHub releases
\item Faster and simpler
\item Uses data as published in the specified release tag
}

When \code{build_from = "source"}:
\itemize{
\item Fetches raw parquet files from source.coop
\item Applies geometry validation and cleaning
\item Converts from wide to long format
\item Slower but ensures fresh data processing
}
}
\examples{
\dontrun{
# Build from latest release (fast)
db_path <- carbon_proj_db()

# Build from source for Africa and Asia only
db_path <- carbon_proj_db(
  continents = c("africa", "asia"),
  build_from = "source"
)

# Use a specific release version
db_path <- carbon_proj_db(
  tag = "v0.0.1",
  build_from = "release"
)

# Force rebuild of existing database
db_path <- carbon_proj_db(force = TRUE)
}

}
